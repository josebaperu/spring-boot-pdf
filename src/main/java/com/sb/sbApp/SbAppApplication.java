package com.sb.sbApp;

import org.apache.pdfbox.pdmodel.PDDocument;
import org.apache.pdfbox.pdmodel.PDPage;
import org.apache.pdfbox.pdmodel.PDPageContentStream;
import org.apache.pdfbox.pdmodel.common.PDRectangle;
import org.apache.pdfbox.pdmodel.font.PDFont;
import org.apache.pdfbox.pdmodel.font.PDType1Font;
import org.apache.pdfbox.pdmodel.font.Standard14Fonts;
import org.apache.pdfbox.pdmodel.graphics.image.PDImageXObject;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.http.HttpStatus;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.CrossOrigin;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import java.io.*;
import java.util.ArrayList;
import java.util.Base64;
import java.util.List;


@SpringBootApplication
@RestController
@RequestMapping("/app")
public class SbAppApplication {
    private static final float FONT_SIZE = 12;
    private static final float LEADING = -1.5f * FONT_SIZE;
    private static final PDFont FONT = new PDType1Font(Standard14Fonts.FontName.TIMES_ROMAN);

    public static void main(String[] args) {
        SpringApplication.run(SbAppApplication.class, args);

    }

    @CrossOrigin(origins = "*")
    @GetMapping(value = "/pdf", produces = MediaType.APPLICATION_PDF_VALUE)
    public ResponseEntity<byte[]> pdf() {

        String paragraph = "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt" +
                " ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco" +
                " laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in " +
                " ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco" +
                " laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in " +
                "voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat" +
                " non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.";

        List<String> content = List.of("first line of text", paragraph, "last line of text");

        byte[] pdfBytes;
        try (final PDDocument doc = new PDDocument()) {

            PDPage page = new PDPage();
            doc.addPage(page);
            PDPageContentStream contentStream = new PDPageContentStream(doc, page);

            PDRectangle mediaBox = page.getMediaBox();
            float marginY = 80;
            float marginX = 60;
            float width = mediaBox.getWidth() - 2 * marginX;
            float startX = mediaBox.getLowerLeftX() + marginX;
            float startY = mediaBox.getUpperRightY() - marginY;


            String base64ImageString = "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";

            byte[] imageBytes = Base64.getDecoder().decode(base64ImageString);
            PDImageXObject pdImage = PDImageXObject.createFromByteArray(doc, imageBytes, "");
            contentStream.drawImage(pdImage, 60, 700);

            contentStream.beginText();
            boolean isFirstLine = true;
            for (String text : content) {
                if (isFirstLine) {
                    isFirstLine = false;
                    addParagraph(contentStream, width, startX, startY, text);
                } else {
                    addParagraph(contentStream, width, 0, -FONT_SIZE, text);
                }
            }
            contentStream.endText();
            contentStream.close();

            ByteArrayOutputStream baos = new ByteArrayOutputStream();
            doc.save(baos);
            doc.close();
            pdfBytes = baos.toByteArray();
            return new ResponseEntity<>(pdfBytes, null, HttpStatus.OK);

        } catch (IOException e) {
            System.err.println("Exception while trying to create pdf document - " + e);
        }
        return null;
    }

    private static void addParagraph(PDPageContentStream contentStream, float width, float sx,
                                     float sy, String text) throws IOException {
        List<String> lines = parseLines(text, width);
        contentStream.setFont(FONT, FONT_SIZE);
        contentStream.newLineAtOffset(sx, sy);
        for (String line : lines) {
            float charSpacing = 0;
            if (line.length() > 1) {
                float size = FONT_SIZE * FONT.getStringWidth(line) / 1000;
                float free = width - size;
                if (free > 0 && !lines.get(lines.size() - 1).equals(line)) {
                    charSpacing = free / (line.length() - 1);
                }
            }
            contentStream.setCharacterSpacing(charSpacing);
            contentStream.showText(line);
            contentStream.newLineAtOffset(0, LEADING);
        }
    }

    private static List<String> parseLines(String text, float width) throws IOException {
        List<String> lines = new ArrayList<>();
        int lastSpace = -1;
        while (text.length() > 0) {
            int spaceIndex = text.indexOf(' ', lastSpace + 1);
            if (spaceIndex < 0)
                spaceIndex = text.length();
            String subString = text.substring(0, spaceIndex);
            float size = FONT_SIZE * FONT.getStringWidth(subString) / 1000;
            if (size > width) {
                if (lastSpace < 0) {
                    lastSpace = spaceIndex;
                }
                subString = text.substring(0, lastSpace);
                lines.add(subString);
                text = text.substring(lastSpace).trim();
                lastSpace = -1;
            } else if (spaceIndex == text.length()) {
                lines.add(text);
                text = "";
            } else {
                lastSpace = spaceIndex;
            }
        }
        return lines;
    }
}
